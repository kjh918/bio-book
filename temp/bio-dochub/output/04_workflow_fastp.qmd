# Trim adapter and remove low quality reads

## fastp (v0.23.4)

> fastp: Picoplex Gold Library PE Trimming<br>- Optimized for Picoplex Gold (14bp front trimming)<br>- Custom adapter sequences for R1/R2<br>- Singularity-based execution for reproducibility

### Execution Script
실제 분석을 구동하기 위해 사용자가 실행하는 래퍼(Wrapper) 스크립트입니다.

```bash
python /storage/home/jhkim/scripts/bioscript/pipeline/cbNIPT/v3.0.0/scripts/run_fastp_picoplexgold_pe_trim_using_singularity.py [arguments...]
```

### Local Command (Internal)
스크립트 내부에서 설정값을 조합하여 실행되는 명령어입니다.

```bash
[singularity_bin] exec -B [bind] [sif] [fastp_bin] --thread [Threads] --in1 \
  [RawFastqDir]/[SeqID]_R1.fastq.gz --in2 [RawFastqDir]/[SeqID]_R2.fastq.gz --out1 \
  [out_read1] --out2 [out_read2] --json [json] --html [html] --trim_poly_g \
  --detect_adapter_for_pe --adapter_sequence [adapter_sequence] \
  --adapter_sequence_r2 [adapter_sequence_r2] --length_required [length_required] \
  --average_qual [average_qual] --qualified_quality_phred \
  [qualified_quality_phred] --trim_front1 [trim_front1] --trim_front2 \
  [trim_front2]
```

### Parameters & I/O

::: {style="font-size: 0.85em;"}

#### Inputs
| Argument | Required | Description |
|:---|:---|:---|
| `SeqID` | ✅ | Sequence identifier used for file naming and sample tracking |
| `RawFastqDir` | ✅ | Directory containing the raw input FASTQ files |
| `TrimFastqDir` | ✅ | Target directory for the processed (trimmed) FASTQ files |
| `qcResDir` | ✅ | Directory for quality control reports (JSON/HTML) |

: {tbl-colwidths="[20, 12, 28, 40]"}

#### Outputs
| Argument | Default | Description |
|:---|:---|:---|
| `out_read1` | [TrimFastqDir]/[SeqID].trimmed_R1.fastq.gz | Final trimmed Read 1 FASTQ |
| `out_read2` | [TrimFastqDir]/[SeqID].trimmed_R2.fastq.gz | Final trimmed Read 2 FASTQ |
| `json` | [qcResDir]/[SeqID].fastp.json | JSON format quality report |
| `html` | [qcResDir]/[SeqID].fastp.html | HTML format quality report |

: {tbl-colwidths="[20, 12, 28, 40]"}

#### Parameters
| Argument | Default | Description |
|:---|:---|:---|
| `singularity_bin` | singularity | Path to the singularity executable |
| `fastp_bin` | fastp | fastp executable name or path inside container |
| `sif` | /storage/images/fastp-0.23.4.sif | Path to fastp Singularity image (.sif) |
| `bind` | /storage,/data | Directories to mount for Singularity |
| `Threads` | 8 | Number of threads for parallel processing |
| `length_required` | 100 | Minimum read length filter |
| `average_qual` | 10 | Minimum average quality filter |
| `qualified_quality_phred` | 15 | Phred quality score threshold (base quality) |
| `trim_front1` | 14 | Number of bases to trim from the start of Read 1 |
| `trim_front2` | 14 | Number of bases to trim from the start of Read 2 |
| `adapter_sequence` | AGATCGGAAGAGCACACGTCTGAACTCCAGTCA | Adapter sequence for Read 1 |
| `adapter_sequence_r2` | AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT | Adapter sequence for Read 2 |

: {tbl-colwidths="[20, 12, 28, 40]"}

:::

***

